@startuml

/' CLASSES DEFINITION '/
class Initializer {
	- Player[] players
	+ Game initializeGame(ArrayList<ClientHandler> clients)
	- void createPlayers(ArrayList<ClientHandler> clients)
	- void createRemoteViews(ArrayList<ClientHandler> clients)
	- void chooseMatchOrder()
	- Game createGame()
}

class GameController {
	- ArrayList<ClientHandler> clients
	- Game game
	- Player[] players
	- ArrayBlockingQueue<Message> messages
	- Game initializeGame(ArrayList<ClientHandler> clients)
	+ void handleMessage(Message message);
}

class TurnController {
	- Game game
	+ void handleBuyCard(Player player, int row, int column, int slot);
	+ void handleMarket(Player player, int row, int column, boolean row_or_column)
	+ void handleProduction(Player player, ProductionInterface production)
	+ void handleEndTurn(Player player)
}

class ResourceController {
	- Game game
	+ void handlePay(Player player, ArrayList<Resource> warehouse, ArrayList<Resource> strongbox, ArrayList<Resource> extraspace);
	+ void handleStore(Player player, ArrayList<Resource> warehouse, ArrayList<Resource> strongbox, ArrayList<Resource> extraspace);
	+ void handleDiscardResources(Player player);
}

class LeaderCardController {
	- Game game
	+ void handleActivateLeader(Player player, LeaderCard leader_card),
	+ void handleDiscardLeader(Player player, LeaderCard leader_card)
}

enum MessageType {
	BUYCARD,
	MARKET,
	PRODUCTION,
	PAY,
	STORE,
	ACTIVATELEADER,
	DISCARDLEADER,
	DISCARDRESOURCES,
	ENDTURN
	' MOVE
}

class Message {
	+ Player player;
	+ MessageType type;
	+ ArrayList<Resource> warehouse;
	+ ArrayList<Resource> strongbox;
	+ ArrayList<Resource> extraspace;
	+ boolean row_or_column;
	+ int row;
	+ int column;
	+ int slot;
	+ ProductionInterface production;
	+ LeaderCard leader_card;
}

interface ServerMessage {
	- boolean error
}

class ErrorMessage {
	+ Player player;
	+ String error;
}

class ViewUpdate {
	+ SimpleGame simple_game;
	+ SimplePlayer simple_player;
	+ Turn turn
}

class RemoteView {
	- Player player
	- ClientHandler client_handler
}

/' RELATIONS DEFINITION '/
Message -- MessageType
Message -- GameController

GameController -- TurnController
GameController -- ResourceController
GameController -- LeaderCardController

ServerMessage <.. ErrorMessage
ServerMessage <.. ViewUpdate

Initializer -- GameController
Initializer -- RemoteView
RemoteView <-up- Observer

GameController <.. Runnable

@enduml
